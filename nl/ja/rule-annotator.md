---

copyright:
  years: 2015, 2018
lastupdated: "2018-03-20"

---

{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:tip: .tip}
{:pre: .pre}
{:codeblock: .codeblock}
{:screen: .screen}
{:javascript: .ph data-hd-programlang='javascript'}
{:java: .ph data-hd-programlang='java'}
{:python: .ph data-hd-programlang='python'}
{:swift: .ph data-hd-programlang='swift'}

この文書は、{{site.data.keyword.cloud}} 上の {{site.data.keyword.knowledgestudiofull}} に関するものです。以前のバージョンの {{site.data.keyword.knowledgestudioshort}} on {{site.data.keyword.IBM_notm}} Marketplace 向けの資料を参照するには、[このリンクをクリック ![外部リンク・アイコン](../../icons/launch-glyph.svg "外部リンク・アイコン")](https://console.bluemix.net/docs/services/knowledge-studio/rule-annotator.html){: new_window} してください。
{: tip}

# ルール
{: #rule-annotator}

文書内のパターンを認識できるルール・ベース・モデルを作成します。ルールを使用して、文書内に出現するパターンを取り込み、基礎となるエンティティー・タイプに関する情報を伝達します。
{: shortdesc}

## クラス概要

ルールを構成するときは、クラスを使用して情報のタイプを表します。これらのクラスは、エンティティー・タイプに似ています。したがって、ここでは、ルールを定義するときにエンティティー・タイプを使用することにします。これからルールを作成するとき、他のより複雑なクラスの作成にのみ使用される中間クラスを定義できます。これらの中間クラスは、便宜的なものに過ぎません。それら単独では役に立ちません。中間クラスは、他の中間クラスと連携して、より有用で完全なクラスを定義するためのものです。中間クラスは必要ですが、タイプ・システムの一部として公開するものではありません。ルール・ベース・モデルが、エンティティーについてのメンションを文書に事前アノテーション付けするなどの有用な操作を実行できるようにするには、ルール作成時に使用する複雑なクラスをタイプ・システムに含まれる同等なエンティティー・タイプにマップする必要があります。

例えば、人の名前を認識できるモデルが必要であるとします。人の名前を認識するように機械学習モデルをトレーニングするには、アノテーション・セット内の文書にさまざまなフォーマットで書かれている多数の名前に `PERSON` エンティティー・タイプを使用してアノテーションを付け、人の名前を認識するようにモデルをトレーニングします。人の名前を認識するルール・ベース・モデルを作成するには、人の名前を書くときに使用されるテキスト・パターンを記述したルールを定義します。したがって、`FirstName` クラスと `LastName` クラスを作成し、そのような中間クラスを使用して `FullName` クラスを定義できます。一般的な接頭部 (`Dr.` など) や一般的な接尾部 (`Jr.`) との関係から `FullName` クラスの位置を決定する条件も定義できます。ルール・ベース・モデルが使用されるときは、`FullName` クラスが `PERSON` エンティティー・タイプにマップされます。

中間クラスからタイプ・システム内のエンティティーへのマッピングを避けるもう 1 つの理由は、ルール・ベース・モデルを使用して文書に事前にアノテーションを付けてから、機械学習モデルのトレーニングのためにそれらをグランドトゥルースに追加した場合、エンティティーへのメンションが重複して生成され、そのようなルールを定義するのは望ましくないからです。例えば、中間クラスである `FirstName` と複合クラスである `FullName` の両方を `PERSON` エンティティーにマップした場合に、`John Doe, Jr.` が出現すると、メンションが重複することになります。

## ルール・エディターのツール

ルール・エディターには、ルールの定義を支援するいくつかのツールが用意されています。

- 辞書

    辞書を追加し、その辞書にクラス名を割り当てます。辞書内の項目に一致する単語が検出されると、それらの単語には、割り当てられたクラスで自動的にアノテーションが付けられます。

- 正規表現

    正規表現 (regex) は、検索パターンを定義する文字のシーケンスです。ルール・エディターに組み込まれている regex ツールは、`java.util.regex.Pattern` の構文に従っている式を認識します。以下に基本的な例を示します。
    `[A-Z][a-z]*`: 大文字で始まる単語を検索します。

    `[A-Z]` は、任意の大文字の英字 (A から Z) に一致し、`[a-z]*` は、ゼロまたは 1 個以上出現する任意の小文字の英字 (a から z) に一致します。アスタリスク (*) は、反復設定 (0 回以上) を定義する文字です。

    検索するパターンを取り込むために使用する正しい式を決定するにあたっては、無料の Web ベースの regex ユーティリティーの使用を検討してください。

    例えば、文書に以下の句に類似した複数の言及があるとします。

    ```
    35-year-old driver
    16-year-old learner
    ```
    {: screen}

    構文 `n-year-old x` は、通常、人物を表すパターンです。正規表現ルールを定義して、`n-year-old x` パターンに一致する句を検出し、それらに `PERSON` エンティティーについてのメンションとしてアノテーションを付けることができます。
